---
title: "Portfolio"
author: "Sidney Francis"
date: "14/02/2021"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: default

---

```{r}
library(spotifyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(usethis)
library(remotes)
library(flexdashboard)
library(compmus)
```
### Plan
Which decade of modern music (60s - 10s) Is the most energetic in movement?
We will determine this by comparing multiple playlists based on 'energy' and 'danceability'

We will use Spotify made playlists of all decades (given the fact that the algorithm is also made by Spotify this seemed fitting).

Playlists used:

- All out 60s 
- All out 70s
- All out 80s
- All out 90s
- All out 00s
- All out 10s
- And because it is just 2021 we will not include the 2020s. 

***
For some reason I'm unable to display more than one graph without them overlapping.


### Chroma/Cepstrograms



I'm Still Standing - Elton John
Self similarities


```{r, echo=FALSE}
ISS <-
  get_tidy_audio_analysis("0lzpfrTARexLFXEACKSXTh") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r}
ISS %>%
  compmus_self_similarity(timbre, "aitchison") %>% 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "Time (s)", y = "Time (s)")

```

```{r}
ISS %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()

```



### Graphs/Visuals



```{r sixties, echo=FALSE}

playlist_username <- 'spotify'
playlist_uris <- c('37i9dQZF1DXaKIA8E7WcJj')
sixties <-
 get_playlist_audio_features(playlist_username, playlist_uris)
```

```{r seventies, echo=FALSE}

playlist_username <- 'spotify'
playlist_uris <- c('37i9dQZF1DWTJ7xPn4vNaz')
seventies <-
 get_playlist_audio_features(playlist_username, playlist_uris)
```

```{r eighties, echo=FALSE}

playlist_username <- 'spotify'
playlist_uris <- c('37i9dQZF1DX4UtSsGT1Sbe')
eighties <-
 get_playlist_audio_features(playlist_username, playlist_uris)
```

```{r nineties, echo=FALSE}

playlist_username <- 'spotify'
playlist_uris <- c('37i9dQZF1DXbTxeAdrVG2l')
nineties <-
 get_playlist_audio_features(playlist_username, playlist_uris)
```

```{r thousands, echo=FALSE}

playlist_username <- 'spotify'
playlist_uris <- c('37i9dQZF1DX4o1oenSJRJd')
thousands <-
 get_playlist_audio_features(playlist_username, playlist_uris)
```

```{r tens, echo=FALSE}

playlist_username <- 'spotify'
playlist_uris <- c('37i9dQZF1DX5Ejj0EkURtP')
tens <-
 get_playlist_audio_features(playlist_username, playlist_uris)
```




```{r, echo=FALSE}
p1 <- ggplot(sixties, aes(x=energy, y=danceability, size =)) + ggtitle("Sixties") +
    geom_point(alpha=0.7)

fig <- ggplotly(p1)

fig <- fig %>% style(point = list(color = 'gold'), hoverinfo = "y", traces = 1)

fig
```

```{r, echo=FALSE}
p2 <- ggplot(seventies, aes(x=energy, y=danceability, size =)) + ggtitle("Seventies") +
    geom_point(alpha=0.7)

fig2 <- ggplotly(p2)

fig2 <- fig2 %>% style(point = list(color = 'gold'), hoverinfo = "y", traces = 1)

fig2
```


```{r, echo=FALSE}
p3 <- ggplot(eighties, aes(x=energy, y=danceability, size =)) + ggtitle("Eighties") +
    geom_point(alpha=0.7)

fig3 <- ggplotly(p3)

fig3 <- fig3 %>% style(point = list(color = 'gold'), hoverinfo = "y", traces = 1)

fig3
```

```{r, ECHo=FALSE}
p4 <- ggplot(nineties, aes(x=energy, y=danceability, size =)) + ggtitle("Nineties") +
    geom_point(alpha=0.7)

fig4 <- ggplotly(p4)

fig4 <- fig4 %>% style(point = list(color = 'gold'), hoverinfo = "y", traces = 1)

fig4
```

```{r, echo=FALSE}
p5 <- ggplot(thousands, aes(x=energy, y=danceability, size =)) + ggtitle("Zeroes") +
    geom_point(alpha=0.7)

fig5 <- ggplotly(p5)

fig5 <- fig5 %>% style(point = list(color = 'gold'), hoverinfo = "y", traces = 1)

fig5
```

```{r, echo=FALSE}
p6 <- ggplot(tens, aes(x=energy, y=danceability, size =)) + ggtitle("Tens") +
    geom_point(alpha=0.7)

fig6 <- ggplotly(p6)

fig6 <- fig6 %>% style(point = list(color = 'gold'), hoverinfo = "y", traces = 1)

fig6
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

                  
```

